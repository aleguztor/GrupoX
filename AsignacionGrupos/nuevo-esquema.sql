CREATE TABLE ALUMNO (ID BIGINT NOT NULL, APELLIDO1 VARCHAR(255) NOT NULL, APELLIDO2 VARCHAR(255), CP_NOTIFICACION VARCHAR(255), DNI VARCHAR(255) NOT NULL UNIQUE, DIRECCION_NOTIFICACION VARCHAR(255), EMAIL_INSTITUCIONAL VARCHAR(255) NOT NULL, EMAIL_PERSONAL VARCHAR(255), LOCALIDAD_NOTIFICACION VARCHAR(255), MOVIL INTEGER, NOMBRE VARCHAR(255) NOT NULL, PROVINCIA_NOTIFICACION VARCHAR(255), TELEFONO INTEGER, PRIMARY KEY (ID))
CREATE TABLE ASIGNATURA (REFERENCIA VARCHAR(255) NOT NULL, OPTATIVA VARCHAR(31), CARACTER VARCHAR(255), CODIGO INTEGER NOT NULL, CREDITOS INTEGER NOT NULL, CURSO VARCHAR(255), DURACION INTEGER, IDIOMA_DE_IMPARTICION TINYINT(1) default 0 NOT NULL, NOMBRE VARCHAR(255) NOT NULL, OFERTADA TINYINT(1) default 0 NOT NULL, UNIDAD_TEMPORAL INTEGER, TITULACION_CODIGO INTEGER, MENCION VARCHAR(255), PRIMARY KEY (REFERENCIA))
CREATE TABLE CENTRO (ID BIGINT NOT NULL, DIRECCION VARCHAR(255) NOT NULL, NOMBRE VARCHAR(255) NOT NULL UNIQUE, TLF_CONSERJERIA INTEGER, PRIMARY KEY (ID))
CREATE TABLE ENCUESTA (FECHA_ENVIO DATE NOT NULL, TURNO_PREFERENTE VARCHAR(255), EXPEDIENTE_NUM_EXPEDIENTE BIGINT NOT NULL, PRIMARY KEY (FECHA_ENVIO, EXPEDIENTE_NUM_EXPEDIENTE))
CREATE TABLE EXPEDIENTE (NUM_EXPEDIENTE BIGINT NOT NULL, ACTIVO TINYINT(1) default 0, NOTA_MEDIA_PROVISIONAL DOUBLE, ALUMNO_ID BIGINT NOT NULL, TITULACION_CODIGO INTEGER, PRIMARY KEY (NUM_EXPEDIENTE))
CREATE TABLE CLASE (CLASES LONGBLOB NOT NULL, HORAFIN TIME, ASIGNATURA_REFERENCIA VARCHAR(255), GRUPO_ID BIGINT NOT NULL, PRIMARY KEY (CLASES, GRUPO_ID))
CREATE TABLE GRUPO (ID BIGINT NOT NULL, ASIGNAR VARCHAR(255), CURSO VARCHAR(255) NOT NULL UNIQUE, INGLES VARCHAR(255), LETRA VARCHAR(255) NOT NULL UNIQUE, PLAZAS BIGINT, TURNO_MANYANA_TARDE VARCHAR(255) NOT NULL, VISIBLE VARCHAR(255), GRUPO_ID BIGINT, TITULACION_CODIGO INTEGER, PRIMARY KEY (ID))
CREATE TABLE MATRICULA (CURSO_ACADEMICO INTEGER NOT NULL, ESTADO CHAR(1) NOT NULL, FECHA_MATRICULA DATE NOT NULL, LISTADO_ASIGNATURAS VARCHAR(255), NUEVO_INGRESO CHAR(1), NUM_ARCHIVO INTEGER, TURNO_PREFERENTE CHAR(1), EXPEDIENTES_NUM_EXPEDIENTES_NUM_EXPEDIENTE BIGINT NOT NULL, PRIMARY KEY (CURSO_ACADEMICO, EXPEDIENTES_NUM_EXPEDIENTES_NUM_EXPEDIENTE))
CREATE TABLE TITULACION (CODIGO INTEGER NOT NULL, CREDITOS INTEGER NOT NULL, NOMBRE VARCHAR(255) NOT NULL, PRIMARY KEY (CODIGO))
CREATE TABLE GRUPOS_POR_ASIGNATURA (CURSO_ACADEMICO VARCHAR(255) NOT NULL, OFERTA TINYINT(1) default 0, ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID BIGINT NOT NULL, PRIMARY KEY (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
CREATE TABLE ASIGNATURAS_MATRICULAS (AM LONGBLOB NOT NULL, ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID BIGINT, PRIMARY KEY (AM, ASIGNATURA_REFERENCIA))
CREATE TABLE TITULACION_CENTRO (centros_ID BIGINT NOT NULL, titulaciones_CODIGO INTEGER NOT NULL, PRIMARY KEY (centros_ID, titulaciones_CODIGO))
CREATE TABLE ENCUESTA_GRUPOS_POR_ASIGNATURA (FECHA_ENVIO DATE NOT NULL, EXPEDIENTE_NUM_EXPEDIENTE BIGINT NOT NULL, CURSO_ACADEMICO VARCHAR(255) NOT NULL, ASIGNATURA_REFERENCIA VARCHAR(255) NOT NULL, GRUPO_ID BIGINT NOT NULL, PRIMARY KEY (FECHA_ENVIO, EXPEDIENTE_NUM_EXPEDIENTE, CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
ALTER TABLE ASIGNATURA ADD CONSTRAINT FK_ASIGNATURA_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE ENCUESTA ADD CONSTRAINT FK_ENCUESTA_EXPEDIENTE_NUM_EXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUM_EXPEDIENTE) REFERENCES EXPEDIENTE (NUM_EXPEDIENTE)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE EXPEDIENTE ADD CONSTRAINT FK_EXPEDIENTE_ALUMNO_ID FOREIGN KEY (ALUMNO_ID) REFERENCES ALUMNO (ID)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE MATRICULA ADD CONSTRAINT MATRICULAEXPEDIENTESNUM_EXPEDIENTES_NUM_EXPEDIENTE FOREIGN KEY (EXPEDIENTES_NUM_EXPEDIENTES_NUM_EXPEDIENTE) REFERENCES EXPEDIENTE (NUM_EXPEDIENTE)
ALTER TABLE GRUPOS_POR_ASIGNATURA ADD CONSTRAINT FK_GRUPOS_POR_ASIGNATURA_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE GRUPOS_POR_ASIGNATURA ADD CONSTRAINT FK_GRUPOS_POR_ASIGNATURA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE ASIGNATURAS_MATRICULAS ADD CONSTRAINT FK_ASIGNATURAS_MATRICULAS_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE ASIGNATURAS_MATRICULAS ADD CONSTRAINT FK_ASIGNATURAS_MATRICULAS_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE TITULACION_CENTRO ADD CONSTRAINT FK_TITULACION_CENTRO_titulaciones_CODIGO FOREIGN KEY (titulaciones_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE TITULACION_CENTRO ADD CONSTRAINT FK_TITULACION_CENTRO_centros_ID FOREIGN KEY (centros_ID) REFERENCES CENTRO (ID)
ALTER TABLE ENCUESTA_GRUPOS_POR_ASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOS_POR_ASIGNATURA_CURSO_ACADEMICO FOREIGN KEY (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID) REFERENCES GRUPOS_POR_ASIGNATURA (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID)
ALTER TABLE ENCUESTA_GRUPOS_POR_ASIGNATURA ADD CONSTRAINT FK_ENCUESTA_GRUPOS_POR_ASIGNATURA_FECHA_ENVIO FOREIGN KEY (FECHA_ENVIO, EXPEDIENTE_NUM_EXPEDIENTE) REFERENCES ENCUESTA (FECHA_ENVIO, EXPEDIENTE_NUM_EXPEDIENTE)
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(38), PRIMARY KEY (SEQ_NAME))
INSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0)
